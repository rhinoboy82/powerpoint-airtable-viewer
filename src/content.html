<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Airtable Viewer</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
  <div id="app">

    <!-- Configuration state -->
    <div id="config-view">
      <div class="config-container">
        <svg class="config-icon" viewBox="0 0 24 24" width="48" height="48" fill="none" stroke="#2d7ff9" stroke-width="1.5">
          <rect x="3" y="3" width="18" height="18" rx="3" />
          <line x1="3" y1="9" x2="21" y2="9" />
          <line x1="3" y1="15" x2="21" y2="15" />
          <line x1="9" y1="3" x2="9" y2="21" />
        </svg>
        <h2>Airtable Viewer</h2>
        <p class="config-subtitle">Paste your Airtable embed URL below</p>
        <input
          type="url"
          id="url-input"
          placeholder="https://airtable.com/embed/shr..."
          spellcheck="false"
          autocomplete="off"
        />
        <button id="load-btn">Load View</button>
        <p id="error-msg" class="hidden"></p>
      </div>
    </div>

    <!-- Display state -->
    <div id="display-view" class="hidden">
      <iframe
        id="airtable-frame"
        frameborder="0"
        width="100%"
        height="100%"
        allow="fullscreen"
        loading="lazy"
      ></iframe>
      <button id="settings-btn" title="Change Airtable URL">
        <svg viewBox="0 0 20 20" width="16" height="16" fill="currentColor">
          <path d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z"/>
        </svg>
      </button>
    </div>

  </div>
</body>
</html>
